<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.17"/>
    <!--    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>-->
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea" style="width: 100%">
        <table cellspacing="0" cellpadding="0" style="margin-bottom: 1em; width: 100%">
            <tbody>
            <tr>
                <td id="projectlogo"><img alt="Logo" src="wrench-logo.png"/></td>
                <td id="projectalign" style="padding-left: 0.5em; margin-bottom: 1em; min-width: 270px">
                    <div id="projectname">WRENCH
                        &#160;<span id="projectnumber">1.11</span>
                    </div>
                    <div id="projectbrief">Cyberinfrastructure Simulation Workbench</div>
                </td>
                <td style="vertical-align: bottom">
                    <a class="link" href="/wrench/1.11/index.html">Overview</a>
                </td>
                <td style="vertical-align: bottom">
                    <a class="link" href="/wrench/1.11/install.html">Installation</a>
                </td>
                <td style="vertical-align: bottom">
                    <a class="link" href="/wrench/1.11/getting-started.html">Getting Started</a>
                </td>
                <td style="vertical-align: bottom">
                    <a class="link" href="/wrench/1.11/wrench-101.html">WRENCH 101</a>
                </td>
                <td style="vertical-align: bottom">
                    <a class="link" href="/wrench/1.11/wrench-102.html">WRENCH 102</a>
                </td>
                <td style="vertical-align: bottom">
                    <div class="dropdown">
                        <button class="dropbtn link">APIs Reference</button>
                        <div class="dropdown-content">
                            <a class="small dropdown-item link"
                               href="/wrench/1.11/user/annotated.html">User</a>
                            <a class="small dropdown-item link"
                               href="/wrench/1.11/developer/annotated.html">Developer</a>
                            <a class="small dropdown-item link"
                               href="/wrench/1.11/internal/annotated.html">Internal</a>
                        </div>
                    </div>
                </td>
                <td style="float: right; min-width: 230px; padding-top: 1em">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
            </tr>
            </tbody>
        </table>
    </div>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Interacting with a cloud compute service </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A cloud service provides mechanisms to manage the set of VMs instantiated on hardware resources. Each VM instance, while it's running, exposes its own bare-metal compute service to which <a class="el" href="guide-102-baremetal.html">standard jobs can be submitted</a>. As a result, one never submits a job directly to a cloud service.</p>
<p>It is possible to create, shutdown, start, suspend, and resume VMs (see a complete list of functions available in the <code><a class="el" href="classwrench_1_1_cloud_compute_service.html" title="A cloud-based compute service that manages a set of physical hosts and controls access to their resou...">wrench::CloudComputeService</a></code> API documentation). The figure below shows the state transition diagram of a VM instance:</p>
<div class="image">
<img src="wrench-guide-cloud-state-diagram.png" alt=""/>
</div>
   <p><br  />
</p>
<p>Here is an example interaction with a <code><a class="el" href="classwrench_1_1_cloud_compute_service.html" title="A cloud-based compute service that manages a set of physical hosts and controls access to their resou...">wrench::CloudComputeService</a></code>:</p>
<div class="fragment"><div class="line"><span class="comment">// Get the first cloud compute service (assuming there&#39;s at least one)</span></div>
<div class="line"><span class="keyword">auto</span> cloud_cs = *(this-&gt;getAvailableComputeServices&lt;wrench::CloudComputeService&gt;().begin());</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a VM with 2 cores and 1 GiB of RAM</span></div>
<div class="line"><span class="keyword">auto</span> vm1 = cloud_cs-&gt;createVM(2, pow(2,30));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a VM with 4 cores and 2 GiB of RAM</span></div>
<div class="line"><span class="keyword">auto</span> vm2 = cloud_cs-&gt;createVM(4, pow(2,31));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Start both VMs and keep track of their associated bare-metal compute services</span></div>
<div class="line">vm1_cs cloud_cs-&gt;startVM(vm1);</div>
<div class="line">vm2_cs cloud_cs-&gt;startVM(vm2);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a job manager</span></div>
<div class="line"><span class="keyword">auto</span> job_manager = this-&gt;createJobManager();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a job</span></div>
<div class="line"><span class="keyword">auto</span> job = job_manager-&gt;createStandardJob({... some tasks ...});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Submit the job to the 1st VM (i.e., to its bare-metal compute service)</span></div>
<div class="line">job_manager-&gt;submitJob(job, vm1_cs);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Sleep for 10 seconds</span></div>
<div class="line">Simulation::sleep(10);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Suspend the 1st VM</span></div>
<div class="line">cloud_cs-&gt;suspend(vm1);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Sleep for 10 seconds</span></div>
<div class="line">Simulation::sleep(10);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Resume the 1st VM</span></div>
<div class="line">cloud_cs-&gt;suspend(vm1);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Wait for and process the next event (should be a standard job completion or failure)</span></div>
<div class="line">this-&gt;waitForAndProcessNextEvent();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Shutdown both VMs</span></div>
<div class="line">cloud_cs-&gt;shutdown(vm1);</div>
<div class="line">cloud_cs-&gt;shutdown(vm2);</div>
</div><!-- fragment --><p>Note that the cloud service will decide on which physical resources VM instances should be started. The underlying physical resources are completely hidden by the cloud service abstraction. If you want more control over how the physical resources are used you likely need a <a class="el" href="guide-102-virtualizedcluster.html">virtualized cluster services</a>.</p>
<p>See the WMS implementation in <code>examples/basic-examples/cloud-bag-of-tasks/TwoTasksAtATimeCloudWMS.cpp</code> for a more complete example.</p>
<hr  />
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="footer">
    <div style="float: left; width: 40%; padding-left: 2em; padding-bottom: 4em !important;">
        <p style="font-size: 0.8em"><strong>&copy;2017-2021 WRENCH. All Rights Reserved.</strong><br/></p>
        <p style="padding-top: 1em">
            <a href="mailto:support@wrench-project.org" class="fa-stack fa-2x" style="font-size: 1.5em">
                <i class="fa fa-circle fa-stack-2x icon-background"></i>
                <i class="fa fa-envelope fa-stack-1x"></i>
            </a>
            <a href="https://twitter.com/wrenchproject" target="_blank" class="fa-stack fa-2x"
               style="font-size: 1.5em">
                <i class="fa fa-circle fa-stack-2x icon-background"></i>
                <i class="fab fa-twitter fa-stack-1x"></i>
            </a>
            <a href="https://github.com/wrench-project/wrench" target="_blank" class="fa-stack fa-2x"
               style="font-size: 1.5em">
                <i class="fa fa-circle fa-stack-2x icon-background"></i>
                <i class="fab fa-github fa-stack-1x"></i>
            </a>
        </p>
    </div>
    <div style="float: right; width: 40%; padding-right: 2em">
        <p style="font-size: 0.8em">
            WRENCH is funded by the National Science Foundation (NSF) under grants number <a
                href="https://nsf.gov/awardsearch/showAward?AWD_ID=2103489" target="_blank">2103489</a>,
            <a href="https://nsf.gov/awardsearch/showAward?AWD_ID=2103508" target="_blank">2103508</a>,
            <a href="https://nsf.gov/awardsearch/showAward?AWD_ID=1923539" target="_blank">1923539</a>, and
            <a href="https://nsf.gov/awardsearch/showAward?AWD_ID=1923621" target="_blank">1923621</a>;
            and the National Center for Scientific Research (CNRS) under grant number PICS07239.
        </p>
        <p style="font-weight: normal; font-size: 0.7em; margin-top: 1em">
            Any opinions, findings, and conclusions or recommendations expressed in this material are those
            of the author(s) and do not necessarily reflect the views of the National Science Foundation.
        </p>
    </div>
</div>
<!-- add the button to toggle the theme -->
<script>
    $(document).ready(function () {
        toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
        toggleButton.title = "Toggle Light/Dark Mode"
        document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
</script>
<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-18066333-6', 'auto');
    ga('send', 'pageview');
</script>
</body>
</html>
