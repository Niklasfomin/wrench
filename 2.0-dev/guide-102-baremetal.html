<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.9.3"/>
    <!--    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>-->
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea" style="width: 100%">
        <table cellspacing="0" cellpadding="0" style="margin-bottom: 1em; width: 100%">
            <tbody>
            <tr>
                <td id="projectlogo"><img alt="Logo" src="wrench-logo.png"/></td>
                <td id="projectalign" style="padding-left: 0.5em; margin-bottom: 1em; min-width: 270px">
                    <div id="projectname">WRENCH
                        &#160;<span id="projectnumber">2.0-dev</span>
                    </div>
                    <div id="projectbrief">Cyberinfrastructure Simulation Workbench</div>
                </td>
                <td style="vertical-align: bottom">
                    <a class="link" href="/wrench/2.0-dev/index.html">Overview</a>
                </td>
                <td style="vertical-align: bottom">
                    <a class="link" href="/wrench/2.0-dev/install.html">Installation</a>
                </td>
                <td style="vertical-align: bottom">
                    <a class="link" href="/wrench/2.0-dev/getting-started.html">Getting Started</a>
                </td>
                <td style="vertical-align: bottom">
                    <a class="link" href="/wrench/2.0-dev/wrench-101.html">WRENCH 101</a>
                </td>
                <td style="vertical-align: bottom">
                    <a class="link" href="/wrench/2.0-dev/wrench-102.html">WRENCH 102</a>
                </td>
                <td style="vertical-align: bottom">
                    <div class="dropdown">
                        <button class="dropbtn link">APIs Reference</button>
                        <div class="dropdown-content">
                            <a class="small dropdown-item link"
                               href="/wrench/2.0-dev/user/annotated.html">User</a>
                            <a class="small dropdown-item link"
                               href="/wrench/2.0-dev/developer/annotated.html">Developer</a>
                            <a class="small dropdown-item link"
                               href="/wrench/2.0-dev/internal/annotated.html">Internal</a>
                        </div>
                    </div>
                </td>
                <td style="float: right; min-width: 230px; padding-top: 1em">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
            </tr>
            </tbody>
        </table>
    </div>
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Interacting with a bare-metal compute service </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md__home_wrench_wrench_doc_wrench_102_baremetal"></a></p>
<p >A <code><a class="el" href="classwrench_1_1_standard_job.html" title="A standard (i.e., non-pilot) workflow job that can be submitted to a ComputeService by a WMS (via a J...">wrench::StandardJob</a></code> can be submitted to a bare-metal compute service via a job manager. For instance:</p>
<div class="fragment"><div class="line">std::shared_ptr&lt;wrench::BareMetalComputeService&gt; some_bare_metal_service;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a job manager</span></div>
<div class="line"><span class="keyword">auto</span> job_manager = this-&gt;createJobManager();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a standard job with 4 workflow tasks </span></div>
<div class="line"><span class="keyword">auto</span> job = job_manager-&gt;createStandardJob(</div>
<div class="line">                 {this-&gt;getWorklow()-&gt;getTaskByID(<span class="stringliteral">&quot;task&quot;</span>),</div>
<div class="line">                  this-&gt;getWorklow()-&gt;getTaskByID(<span class="stringliteral">&quot;task2&quot;</span>),</div>
<div class="line">                  this-&gt;getWorklow()-&gt;getTaskByID(<span class="stringliteral">&quot;task3&quot;</span>),</div>
<div class="line">                  this-&gt;getWorklow()-&gt;getTaskByID(<span class="stringliteral">&quot;task4&quot;</span>)});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Submit the job to the bare-metal service</span></div>
<div class="line">job_manager-&gt;submitJob(job, some_bare_metal_service);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//  Wait for and process the next event (should be a standard job completion or failure)</span></div>
<div class="line">this-&gt;waitForAndProcessNextEvent();</div>
</div><!-- fragment --><p >In the above, the bare-metal service will make all decisions for deciding how to allocate compute resources (i.e., cores) to tasks. In fact, several properties (see class <code><a class="el" href="classwrench_1_1_bare_metal_compute_service_property.html" title="Configurable properties for a bare_metal_standard_jobs.">wrench::BareMetalComputeServiceProperty</a></code>) can be set to change the algorithms used by the service to determine resource allocations.</p>
<p >In some cases, the execution controller may want to influence or enforce resource allocations for the tasks in the jobs. For this purpose, the <code><a class="el" href="classwrench_1_1_job_manager.html#a97d2705f1e1d4a6453c1f93c9a578e0e" title="Submit a standard job to a compute service.">wrench::JobManager::submitJob()</a></code> method takes an optional <b>service-specific argument</b>. This argument is a <code>std::map&lt;std::string, std::string&gt;</code> of key-value pairs. The key is a task ID, and the value is the service-specific argument for that task.</p>
<p >For each task, an optional argument can be provided as a string formatted as "hostname:num_cores", "hostname", or "num_cores", where "hostname" is the name of one of the service's compute hosts and "num_cores" is an integer (e.g., "host1:10", "host1", "10"):</p>
<ul>
<li>If no value is provided for a task, or if the value is the empty string, then the bare-metal service will choose the host on which the task should be executed (typically the host with the lowest current load), and will execute the task with as many cores as possible on that host.</li>
<li>If a "hostname" value is provided for a task, then the bare-metal service will execute the task on that host, and will execute the task with as many cores as possible on that host.</li>
<li>If a "num_cores" value is provided for a task, then the bare-metal service will choose the host on which the task should be executed (typically the host with the lowest current load), and will execute the task with the specified number of cores.</li>
<li>If a "hostname:num_cores" value is provided for a task, then the bare-metal service will execute the task on that host with the specified number of cores.</li>
</ul>
<p >In the above example, for instance, the job submission could be done as: </p><div class="fragment"><div class="line">[...]</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a service-specific argument</span></div>
<div class="line">std::map&lt;std::string, std::string&gt; service_specific_args;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// task will run on host Node1 with as many cores as possible</span></div>
<div class="line">service_specific_args[<span class="stringliteral">&quot;task&quot;</span>] = <span class="stringliteral">&quot;Node1&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// task2 will run on host Node2 with 16 cores</span></div>
<div class="line">service_specific_args[<span class="stringliteral">&quot;task2&quot;</span>] = <span class="stringliteral">&quot;Node2:16&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// task3 will run on any host with as many cores as possible</span></div>
<div class="line">service_specific_args[<span class="stringliteral">&quot;task3&quot;</span>] = <span class="stringliteral">&quot;&quot;</span>;  <span class="comment">// could be omitted altogether</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// task4 will run on some host with 4 cores</span></div>
<div class="line">service_specific_args[<span class="stringliteral">&quot;task4&quot;</span>] = <span class="stringliteral">&quot;4&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Submit the job</span></div>
<div class="line">job_manager-&gt;submitJob(job, some_bare_metal_service, service_specific_args);</div>
<div class="line"> </div>
<div class="line">[...]</div>
</div><!-- fragment --><p >If the service-specific arguments are invalid (e.g., invalid hostname, unknown task, number of cores too large), the <code><a class="el" href="classwrench_1_1_job_manager.html#a97d2705f1e1d4a6453c1f93c9a578e0e" title="Submit a standard job to a compute service.">wrench::JobManager::submitJob()</a></code> method throws a <code><a class="el" href="classwrench_1_1_execution_exception.html" title="An generic exception that is thrown whenever something unexpected (but simulation-valid) occurs durin...">wrench::ExecutionException</a></code>.</p>
<p >See the execution controller implementation in <code>examples/basic-examples/bare-metal-bag-of-tasks/TwoTasksAtATimeWMS.cpp</code> for a more complete example.</p>
<hr  />
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="footer">
    <div style="float: left; width: 40%; padding-left: 2em; padding-bottom: 4em !important;">
        <p style="font-size: 0.8em"><strong>&copy;2017-2021 WRENCH. All Rights Reserved.</strong><br/></p>
        <p style="padding-top: 1em">
            <a href="mailto:support@wrench-project.org" class="fa-stack fa-2x" style="font-size: 1.5em">
                <i class="fa fa-circle fa-stack-2x icon-background"></i>
                <i class="fa fa-envelope fa-stack-1x"></i>
            </a>
            <a href="https://twitter.com/wrenchproject" target="_blank" class="fa-stack fa-2x"
               style="font-size: 1.5em">
                <i class="fa fa-circle fa-stack-2x icon-background"></i>
                <i class="fab fa-twitter fa-stack-1x"></i>
            </a>
            <a href="https://github.com/wrench-project/wrench" target="_blank" class="fa-stack fa-2x"
               style="font-size: 1.5em">
                <i class="fa fa-circle fa-stack-2x icon-background"></i>
                <i class="fab fa-github fa-stack-1x"></i>
            </a>
        </p>
    </div>
    <div style="float: right; width: 40%; padding-right: 2em">
        <p style="font-size: 0.8em">
            WRENCH is funded by the National Science Foundation (NSF) under grants number <a
                href="https://nsf.gov/awardsearch/showAward?AWD_ID=2103489" target="_blank">2103489</a>,
            <a href="https://nsf.gov/awardsearch/showAward?AWD_ID=2103508" target="_blank">2103508</a>,
            <a href="https://nsf.gov/awardsearch/showAward?AWD_ID=1923539" target="_blank">1923539</a>, and
            <a href="https://nsf.gov/awardsearch/showAward?AWD_ID=1923621" target="_blank">1923621</a>;
            and the National Center for Scientific Research (CNRS) under grant number PICS07239.
        </p>
        <p style="font-weight: normal; font-size: 0.7em; margin-top: 1em">
            Any opinions, findings, and conclusions or recommendations expressed in this material are those
            of the author(s) and do not necessarily reflect the views of the National Science Foundation.
        </p>
    </div>
</div>
<!-- add the button to toggle the theme -->
<script>
    $(document).ready(function () {
        toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
        toggleButton.title = "Toggle Light/Dark Mode"
        document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
</script>
<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-18066333-6', 'auto');
    ga('send', 'pageview');
</script>
</body>
</html>
